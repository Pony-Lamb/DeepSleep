<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DeepSleep - Investment Management</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet" />

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

    :root {
      --primary: #1E3A8A;
      --background: #F8FAFC;
      --positive: #10B981;
      --negative: #EF4444;
      --action: #3B82F6;
      --divider: #E2E8F0;
    }

    body {
      font-family: 'Roboto', 'Segoe UI', Arial, sans-serif;
      background-color: var(--background);
      height: 100vh;
      overflow: hidden;
    }

    .glass-nav {
      background: rgba(248, 250, 252, 0.8);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-right: 1px solid var(--divider);
    }

    .stock-card {
      background: white;
      border: 0.5px solid var(--divider);
      border-radius: 8px;
      box-shadow: 0 2px 3px rgba(0, 0, 0, 0.05);
      transition: all 0.3s ease;
    }

    .stock-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .stock-detail-card {
      background: white;
      border: 0.5px solid var(--divider);
      border-radius: 8px;
      box-shadow: 0 2px 3px rgba(0, 0, 0, 0.05);
      transition: all 0.3s ease;
      margin: 3px;
      padding: 1rem;
    }

    .stock-detail-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .buy-btn {
      background: var(--action);
      height: 48px;
      transition: all 0.2s ease;
    }

    .buy-btn:hover {
      background: #2563eb;
    }

    .positive-change {
      color: var(--positive);
    }

    .negative-change {
      color: var(--negative);
    }

    /* Override Tailwind base */
    .w-20-percent {
      width: 20%;
    }

    .w-80-percent {
      width: 80%;
    }

    #tradingPanel {
      display: block;
    }

    #mainPanel,
    #portfolioPanel {
      display: none;
    }

    /* Modal styling */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 40;
      display: none;
    }

    .modal-content {
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }

    .search-results {
      display: none;
      position: absolute;
      z-index: 30;
      width: 100%;
      max-height: 300px;
      overflow-y: auto;
      background: white;
      box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
      border-radius: 8px;
    }

    .text-rise {
    color: var(--positive);
  }

  .text-fall {
    color: var(--negative);
  }

  .bg-rise {
    background-color: var(--positive);
  }

  .bg-fall {
    background-color: var(--negative);
  }

  .bg-rise\/10 {
    background-color: rgba(16, 185, 129, 0.1);
  }

  .bg-fall\/10 {
    background-color: rgba(239, 68, 68, 0.1);
  }

  .active-period {
    background-color: var(--action);
    color: white;
  }

  .inactive-period {
    background-color: var(--divider);
    color: var(--text-secondary);
  }

  .inactive-period:hover {
    background-color: #cbd5e1;
  }

  .chart-container {
    border-radius: 12px;
    overflow: hidden;
    background: white;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
  }

  </style>
</head>

<body class="flex">
  <!-- Left Navigation Panel -->
  <div class="glass-nav w-20-percent h-screen flex flex-col justify-between py-8">
    <div>
      <div class="pl-8 pb-10">
        <h1 class="text-3xl font-bold text-gray-800">DeepSleep</h1>
      </div>

      <nav class="space-y-4 px-6">
        <button
          class="w-full flex items-center p-4 rounded-xl text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition"
          onclick="switchPanel('mainPanel')">
          <iconify-icon icon="mdi:home-outline" class="text-xl mr-3"></iconify-icon>
          <span class="text-lg font-medium">Home</span>
        </button>

        <button class="w-full flex items-center p-4 rounded-xl bg-blue-100 text-blue-800 font-medium"
          onclick="switchPanel('tradingPanel')">
          <iconify-icon icon="mdi:stock-market" class="text-xl mr-3"></iconify-icon>
          <span class="text-lg font-medium">Stock Trading</span>
        </button>

        <button
          class="w-full flex items-center p-4 rounded-xl text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition"
          onclick="switchPanel('portfolioPanel')">
          <iconify-icon icon="mdi:finance" class="text-xl mr-3"></iconify-icon>
          <span class="text-lg font-medium">Portfolio</span>
        </button>
      </nav>
    </div>

    <div class="px-6">
      <div class="flex items-center p-4 bg-blue-50 rounded-2xl">
        <img src="https://modao.cc/ai/uploads/ai_pics/6/66422/aigp_1753747613.jpeg" alt="User profile avatar"
          id="user-avatar" width="52" height="52" class="rounded-full">
        <div class="ml-4">
          <p class="font-semibold text-gray-800">Michael Chen</p>
          <p class="text-sm text-gray-600">Senior Investor</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content Area -->
  <div class="w-80-percent h-screen overflow-auto">
    <!-- Trading Panel -->
    <section id="tradingPanel" class="pt-8">
      <!-- Top Bar with Search -->
      <div class="mx-auto px-12 max-w-6xl">
        <div class="relative mb-10">
          <div class="flex">
            <iconify-icon icon="mdi:search" class="absolute left-4 top-4 text-2xl text-gray-400"></iconify-icon>
            <input type="text" placeholder="Search stocks by name or symbol..."
              class="w-full py-4 pl-12 pr-5 rounded-xl border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none shadow-sm"
              oninput="showSearchResults()">
          </div>
          <div id="searchResults" class="search-results mt-2 p-3"></div>
        </div>

        <h2 class="text-3xl font-bold text-gray-800 mb-8">Stocks Market Overview</h2>

        <!-- Stock Cards Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Stock Card 1 -->
          <div class="stock-card p-6 cursor-pointer" onclick="showStockDetail('AAPL')">
            <div class="flex justify-between items-start mb-4">
              <div>
                <h3 class="font-bold text-xl text-gray-800">Apple Inc.</h3>
                <p class="text-gray-500">AAPL</p>
              </div>
              <img src="https://modao.cc/ai/uploads/ai_pics/6/66423/aigp_1753747615.jpeg" alt="Apple Inc. company logo"
                id="stock-logo1" class="w-12 h-12">
            </div>

            <div class="mb-6">
              <p class="text-2xl font-bold text-gray-900">$175.42</p>
              <div class="flex items-center positive-change">
                <iconify-icon icon="mdi:trending-up" class="mr-1"></iconify-icon>
                <span>+2.35% ($4.03)</span>
              </div>
            </div>

            <button class="buy-btn w-full text-white font-bold rounded-full py-3 flex items-center justify-center"
              onclick="showTradeModal('AAPL', 175.42)">
              <iconify-icon icon="mdi:cart-arrow-down" class="mr-2"></iconify-icon>
              Buy Stock
            </button>
          </div>

          <!-- Stock Card 2 -->
          <div class="stock-card p-6 cursor-pointer" onclick="showStockDetail('MSFT')">
            <div class="flex justify-between items-start mb-4">
                <div>
                <h3 class="font-bold text-xl text-gray-800">Microsoft Corp.</h3>
                <p class="text-gray-500">MSFT</p>
                </div>
                <img src="https://modao.cc/ai/uploads/ai_pics/6/66424/aigp_1753747617.jpeg"
                alt="Microsoft Corporation company logo" class="w-12 h-12">
            </div>

            <div class="mb-6">
                <p class="text-2xl font-bold text-gray-900">$336.21</p>
                <div class="flex items-center positive-change">
                <iconify-icon icon="mdi:trending-up" class="mr-1"></iconify-icon>
                <span>+1.64% ($5.42)</span>
                </div>
            </div>

            <button class="buy-btn w-full text-white font-bold rounded-full py-3 flex items-center justify-center"
                onclick="showTradeModal('MSFT', 336.21); event.stopPropagation();">
                <iconify-icon icon="mdi:cart-arrow-down" class="mr-2"></iconify-icon>
                Buy Stock
            </button>
        </div>

          <!-- Stock Card 3 -->
        <div class="stock-card p-6 cursor-pointer" onclick="showStockDetail('AMZN')">
        <div class="flex justify-between items-start mb-4">
            <div>
            <h3 class="font-bold text-xl text-gray-800">Amazon.com Inc.</h3>
            <p class="text-gray-500">AMZN</p>
            </div>
            <img src="https://modao.cc/ai/uploads/ai_pics/6/66425/aigp_1753747619.jpeg" alt="Amazon.com company logo"
            class="w-12 h-12">
        </div>

        <div class="mb-6">
            <p class="text-2xl font-bold text-gray-900">$132.75</p>
            <div class="flex items-center negative-change">
            <iconify-icon icon="mdi:trending-down" class="mr-1"></iconify-icon>
            <span>-0.87% ($1.16)</span>
            </div>
        </div>

        <button class="buy-btn w-full text-white font-bold rounded-full py-3 flex items-center justify-center"
            onclick="showTradeModal('AMZN', 132.75); event.stopPropagation();">
            <iconify-icon icon="mdi:cart-arrow-down" class="mr-2"></iconify-icon>
            Buy Stock
        </button>
        </div>

          <!-- Stock Card 4 -->
          <div class="stock-card p-6 cursor-pointer" onclick="showStockDetail('TSLA')">
            <div class="flex justify-between items-start mb-4">
                <div>
                <h3 class="font-bold text-xl text-gray-800">Tesla Inc.</h3>
                <p class="text-gray-500">TSLA</p>
                </div>
                <img src="https://modao.cc/ai/uploads/ai_pics/6/66426/aigp_1753747621.jpeg" alt="Tesla Inc. company logo"
                class="w-12 h-12">
            </div>

            <div class="mb-6">
                <p class="text-2xl font-bold text-gray-900">$258.93</p>
                <div class="flex items-center negative-change">
                <iconify-icon icon="mdi:trending-down" class="mr-1"></iconify-icon>
                <span>-3.25% ($8.71)</span>
                </div>
            </div>

            <button class="buy-btn w-full text-white font-bold rounded-full py-3 flex items-center justify-center"
                onclick="showTradeModal('TSLA', 258.93); event.stopPropagation();">
                <iconify-icon icon="mdi:cart-arrow-down" class="mr-2"></iconify-icon>
                Buy Stock
            </button>
        </div>

          <!-- Stock Card 5 -->
        <div class="stock-card p-6 cursor-pointer" onclick="showStockDetail('GOOGL')">
            <div class="flex justify-between items-start mb-4">
                <div>
                <h3 class="font-bold text-xl text-gray-800">Google LLC</h3>
                <p class="text-gray-500">GOOGL</p>
                </div>
                <img src="https://modao.cc/ai/uploads/ai_pics/6/66427/aigp_1753747622.jpeg" alt="Google LLC company logo"
                class="w-12 h-12">
            </div>

            <div class="mb-6">
                <p class="text-2xl font-bold text-gray-900">$138.04</p>
                <div class="flex items-center positive-change">
                <iconify-icon icon="mdi:trending-up" class="mr-1"></iconify-icon>
                <span>+1.22% ($1.66)</span>
                </div>
            </div>

            <button class="buy-btn w-full text-white font-bold rounded-full py-3 flex items-center justify-center"
                onclick="showTradeModal('GOOGL', 138.04); event.stopPropagation();">
                <iconify-icon icon="mdi:cart-arrow-down" class="mr-2"></iconify-icon>
                Buy Stock
            </button>
        </div>

          <!-- Stock Card 6 -->
        <div class="stock-card p-6 cursor-pointer" onclick="showStockDetail('NFLX')">
            <div class="flex justify-between items-start mb-4">
                <div>
                <h3 class="font-bold text-xl text-gray-800">Netflix Inc.</h3>
                <p class="text-gray-500">NFLX</p>
                </div>
                <img src="https://modao.cc/ai/uploads/ai_pics/6/66428/aigp_1753747623.jpeg"
                alt="Netflix Inc. company logo" class="w-12 h-12">
            </div>

            <div class="mb-6">
                <p class="text-2xl font-bold text-gray-900">$483.32</p>
                <div class="flex items-center positive-change">
                <iconify-icon icon="mdi:trending-up" class="mr-1"></iconify-icon>
                <span>+4.63% ($21.36)</span>
                </div>
            </div>

            <button class="buy-btn w-full text-white font-bold rounded-full py-3 flex items-center justify-center"
                onclick="showTradeModal('NFLX', 483.32); event.stopPropagation();">
                <iconify-icon icon="mdi:cart-arrow-down" class="mr-2"></iconify-icon>
                Buy Stock
            </button>
            </div>
        </div>
      </div>

    </section>

    <!-- Dashboard Panel -->

    <!-- Portfolio Panel -->
    <section id="portfolioPanel" class="pt-8 hidden">
      <div class="mx-auto px-12 max-w-6xl">
        <div class="flex justify-between items-center mb-8">
          <h2 class="text-3xl font-bold text-gray-800">Portfolio</h2>
          <button class="flex items-center px-5 py-2.5 rounded-xl bg-blue-100 text-blue-700 font-medium">
            <iconify-icon icon="mdi:file-export-outline" class="mr-2"></iconify-icon>
            Export Report
          </button>
        </div>

        <!-- 持仓名称列表 -->
        <div class="flex gap-4 mb-6 overflow-x-auto py-2">
          <button class="px-5 py-2.5 rounded-xl bg-blue-600 text-white font-medium portfolio-btn active"
            data-portfolio="portfolio1">US Stocks</button>
          <button class="px-5 py-2.5 rounded-xl bg-gray-100 text-gray-700 font-medium portfolio-btn"
            data-portfolio="portfolio2">Hong Kong Stocks</button>
          <button class="px-5 py-2.5 rounded-xl bg-gray-100 text-gray-700 font-medium portfolio-btn"
            data-portfolio="portfolio3">China A-Shares</button>
          <button class="px-5 py-2.5 rounded-xl bg-gray-100 text-gray-700 font-medium portfolio-btn"
            data-portfolio="portfolio4">Cryptocurrencies</button>
        </div>

        <div class="grid grid-cols-3 gap-6 mb-8">
          <!-- Performance Summary -->
          <div class="glass-nav rounded-xl p-6">
            <h3 class="font-medium text-gray-700 mb-3">Total Value</h3>
            <p class="text-2xl font-bold text-gray-900">$126,842.50</p>
          </div>

          <!-- Today's Change -->
          <div class="glass-nav rounded-xl p-6">
            <h3 class="font-medium text-gray-700 mb-3">Today's Change</h3>
            <div class="flex items-center">
              <iconify-icon icon="mdi:trending-up" class="text-xl text-green-500 mr-1"></iconify-icon>
              <p class="text-2xl font-bold text-gray-900">+$1,842.50</p>
            </div>
          </div>

          <!-- Performance Percentage -->
          <div class="glass-nav rounded-xl p-6">
            <h3 class="font-medium text-gray-700 mb-3">All Time Return</h3>
            <div class="flex items-center">
              <iconify-icon icon="mdi:arrow-top-right-thick" class="text-xl text-green-500 mr-1"></iconify-icon>
              <p class="text-2xl font-bold text-gray-900">+24.3%</p>
            </div>
          </div>
        </div>

        <!-- Portfolio Holdings -->
        <div class="glass-nav rounded-xl p-6">
          <h3 class="text-xl font-bold text-gray-800 mb-6">Current Holdings - <span id="currentPortfolioName">US
              Stocks</span></h3>
          <div class="overflow-x-auto">
            <table class="w-full">
              <thead>
                <tr class="border-b border-gray-100">
                  <th class="text-right py-3 font-bold text-gray-700">Actions</th>
                  <th class="text-left py-3 font-bold text-gray-700">Asset</th>
                  <th class="text-right py-3 font-bold text-gray-700">Quantity</th>
                  <th class="text-right py-3 font-bold text-gray-700">Average Cost</th>
                  <th class="text-right py-3 font-bold text-gray-700">Current Price</th>
                  <th class="text-right py-3 font-bold text-gray-700">Market Value</th>
                  <th class="text-right py-3 font-bold text-gray-700">Daily Change</th>
                </tr>
              </thead>
              <tbody>
                <!-- Holding Row 1 -->
                <tr class="border-b border-gray-100">
                  <td class="py-4">
                    <div class="flex items-center">
                      <img src="https://modao.cc/ai/uploads/ai_pics/6/66429/aigp_1753747625.jpeg"
                        alt="Apple Inc. company logo" id="holding-logo1" class="w-10 h-10 rounded mr-3">
                      <div>
                        <p class="font-semibold text-gray-800">Apple Inc.</p>
                        <p class="text-sm text-gray-500">AAPL</p>
                      </div>
                    </div>
                  </td>
                  <td class="text-right align-middle py-4 font-medium">85</td>
                  <td class="text-right align-middle py-4 font-medium">$142.31</td>
                  <td class="text-right align-middle py-4 font-bold">$175.42</td>
                  <td class="text-right align-middle py-4 font-bold">$14,910.70</td>
                  <td class="text-right align-middle py-4 font-medium positive-change">+2.35%</td>
                  <td class="text-right align-middle py-4">
                    <button class="px-3 py-1 bg-red-500 text-white rounded-md" onclick="showSellModal('AAPL', 175.42)">
                      Sell
                    </button>
                  </td>
                </tr>

                <!-- Holding Row 2 -->
                <tr class="border-b border-gray-100">
                  <td class="py-4">
                    <div class="flex items-center">
                      <img src="https://modao.cc/ai/uploads/ai_pics/6/66430/aigp_1753747627.jpeg"
                        alt="Microsoft Corp. company logo" id="holding-logo2" class="w-10 h-10 rounded mr-3">
                      <div>
                        <p class="font-semibold text-gray-800">Microsoft Corp.</p>
                        <p class="text-sm text-gray-500">MSFT</p>
                      </div>
                    </div>
                  </td>
                  <td class="text-right align-middle py-4 font-medium">42</td>
                  <td class="text-right align-middle py-4 font-medium">$318.75</td>
                  <td class="text-right align-middle py-4 font-bold">$336.21</td>
                  <td class="text-right align-middle py-4 font-bold">$14,120.82</td>
                  <td class="text-right align-middle py-4 font-medium positive-change">+1.64%</td>
                  <td class="text-right align-middle py-4">
                    <button class="px-3 py-1 bg-red-500 text-white rounded-md" onclick="showSellModal('MSFT', 336.21)">
                      Sell
                    </button>
                  </td>
                </tr>

                <!-- Holding Row 3 -->
                <tr class="border-b border-gray-100">
                  <td class="py-4">
                    <div class="flex items-center">
                      <img src="https://modao.cc/ai/uploads/ai_pics/6/66431/aigp_1753747629.jpeg"
                        alt="Amazon.com Inc. company logo" id="holding-logo3" class="w-10 h-10 rounded mr-3">
                      <div>
                        <p class="font-semibold text-gray-800">Amazon.com Inc.</p>
                        <p class="text-sm text-gray-500">AMZN</p>
                      </div>
                    </div>
                  </td>
                  <td class="text-right align-middle py-4 font-medium">64</td>
                  <td class="text-right align-middle py-4 font-medium">$135.20</td>
                  <td class="text-right align-middle py-4 font-bold">$132.75</td>
                  <td class="text-right align-middle py-4 font-bold">$8,496.00</td>
                  <td class="text-right align-middle py-4 font-medium negative-change">-0.87%</td>
                  <td class="text-right align-middle py-4">
                    <button class="px-3 py-1 bg-red-500 text-white rounded-md" onclick="showSellModal('AMZN', 132.75)">
                      Sell
                    </button>
                  </td>
                </tr>

                <!-- Holding Row 4 -->
                <tr>
                  <td class="py-4">
                    <div class="flex items-center">
                      <img src="https://modao.cc/ai/uploads/ai_pics/6/66432/aigp_1753747631.jpeg"
                        alt="S&amp;P 500 ETF Trust logo" id="holding-logo4" class="w-10 h-10 rounded mr-3">
                      <div>
                        <p class="font-semibold text-gray-800">SPDR S&amp;P 500 ETF</p>
                        <p class="text-sm text-gray-500">SPY</p>
                      </div>
                    </div>
                  </td>
                  <td class="text-right align-middle py-4 font-medium">120</td>
                  <td class="text-right align-middle py-4 font-medium">$421.80</td>
                  <td class="text-right align-middle py-4 font-bold">$458.37</td>
                  <td class="text-right align-middle py-4 font-bold">$55,004.40</td>
                  <td class="text-right align-middle py-4 font-medium positive-change">+0.92%</td>
                  <td class="text-right align-middle py-4">
                    <button class="px-3 py-1 bg-red-500 text-white rounded-md" onclick="showSellModal('SPY', 458.37)">
                      Sell
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="flex justify-center mt-8">
            <button class="flex items-center px-5 py-2.5 rounded-xl border border-blue-500 text-blue-700 font-medium"
              onclick="showAddPositionModal()">
              <iconify-icon icon="mdi:plus" class="mr-2"></iconify-icon>
              Add New Position
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Stock Detail Panel -->
    <!-- <section id="stockDetailPanel" class="pt-8 hidden">
      <div class="mx-auto px-12 max-w-2xl bg-white rounded-xl shadow-lg p-8">
        <a href="javascript:void(0);" onclick="backToTradingPanel()"
          class="text-blue-600 hover:underline mb-4 inline-block">
          ← Back to Market
        </a>
      </div>

      
    </section> -->
    <!-- Replace the entire stockDetailPanel section with this improved version -->
<section id="stockDetailPanel" class="pt-8 hidden">
  <div class="mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl">
    <a href="javascript:void(0);" onclick="backToTradingPanel()"
       class="inline-flex items-center text-blue-600 hover:text-blue-800 mb-6 transition-colors duration-200">
      <iconify-icon icon="mdi:arrow-left" class="mr-2"></iconify-icon>
      Back to Market
    </a>
    
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
      <div class="flex flex-col md:flex-row md:items-center justify-between mb-8">
        <div class="flex items-center mb-6 md:mb-0">
          <img id="detail-stock-logo" src="" alt="logo" class="w-16 h-16 rounded-xl mr-6 shadow-md">
          <div>
            <h1 class="text-2xl md:text-3xl font-bold text-gray-900" id="detail-stock-name"></h1>
            <p class="text-gray-500 text-lg" id="detail-stock-symbol"></p>
          </div>
        </div>
        <div class="flex flex-col items-end">
          <p class="text-3xl font-bold text-gray-900">$<span id="detail-stock-price"></span></p>
          <div class="flex items-center mt-2" id="detail-stock-change"></div>
        </div>
      </div>

      <!-- <div class="mb-8">
        <h2 class="text-xl font-semibold mb-4 text-gray-900">About</h2>
        <p class="text-gray-700 leading-relaxed" id="detail-stock-desc">No description available.</p>
      </div> -->
    </div>
    
    <div class="bg-white rounded-2xl shadow-lg p-6">
      <div class="flex flex-col md:flex-row md:items-center justify-between mb-6">
        <div>
          <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-gray-900" id="detail-page-title">AAPL Apple Inc.</h1>
          <p class="text-gray-400">NASDAQ · US Stock</p>
        </div>
        <div class="mt-4 md:mt-0 flex items-center">
          <span class="text-2xl font-bold mr-3 text-rise">195.11</span>
          <span class="bg-rise/10 text-rise px-2 py-1 rounded text-sm flex items-center">
            <i class="fa fa-caret-up mr-1"></i>0.83 (0.43%)
          </span>
        </div>
      </div>
      
      <!-- Stock overview data -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
        <div class="stock-detail-card">
          <div class="text-gray-400 text-sm">Open</div>
          <div class="text-lg font-semibold mt-1">194.27</div>
        </div>
        <div class="stock-detail-card">
          <div class="text-gray-400 text-sm">Close</div>
          <div class="text-lg font-semibold mt-1 text-rise">195.11</div>
        </div>
        <div class="stock-detail-card">
          <div class="text-gray-400 text-sm">High</div>
          <div class="text-lg font-semibold mt-1 text-rise">195.89</div>
        </div>
        <div class="stock-detail-card">
          <div class="text-gray-400 text-sm">Low</div>
          <div class="text-lg font-semibold mt-1">192.83</div>
        </div>
      </div>
      
      <!-- Time period selector -->
      <div class="flex flex-wrap gap-2 mb-6">
        <button class="active-period px-4 py-2 rounded-md text-sm font-medium" data-days="30">30 Days</button>
        <button class="inactive-period px-4 py-2 rounded-md text-sm font-medium" data-days="60">60 Days</button>
        <button class="inactive-period px-4 py-2 rounded-md text-sm font-medium" data-days="90">90 Days</button>
      </div>
      
      <!-- K-line chart container -->
      <div class="chart-container h-[500px] mb-6">
        <div id="stockChart" class="w-full h-full"></div>
      </div>
      
      <!-- Chart explanation -->
      <div class="bg-blue-50 rounded-lg p-4 text-sm text-blue-800">
        <p><i class="fa fa-info-circle mr-2"></i>Chart Explanation: Red candlesticks indicate price increase (closing price higher than opening price), green candlesticks indicate price decrease (closing price lower than opening price). The upper and lower shadows of the candlesticks represent the highest and lowest prices of the day, respectively. Bollinger Bands consist of a middle band (SMA) and two outer bands representing volatility.</p>
      </div>
    </div>
  </div>
</section>
  </div>

  <!-- Sell Modal -->
  <div id="sellModal" class="modal-overlay">
    <div class="flex items-center justify-center h-full">
      <div class="modal-content p-8 w-11/12 max-w-md">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-bold text-gray-800">Confirm Sale</h3>
          <button onclick="closeSellModal()">
            <iconify-icon icon="mdi:close" class="text-2xl"></iconify-icon>
          </button>
        </div>

        <div class="flex items-center mb-6">
          <img id="modal-sell-logo" src="https://modao.cc/ai/uploads/ai_pics/6/66433/aigp_1753747632.jpeg"
            alt="Company logo for stock trading" class="w-16 h-16 rounded mr-4">
          <div>
            <p class="font-bold text-lg" id="modal-sell-name">Apple Inc. (AAPL)</p>
            <p class="text-gray-600">Current price: $<span id="modal-sell-price">0.00</span></p>
          </div>
        </div>

        <div class="mb-6">
          <label class="block text-gray-700 mb-3">Quantity to Sell</label>
          <div class="relative">
            <input type="number" min="1" value="5" class="w-full p-3 border border-gray-300 rounded-lg font-medium">
            <div class="flex justify-between mt-2 text-sm">
              <button class="px-3 py-1 bg-gray-100 rounded"
                onclick="this.parentElement.previousElementSibling.stepDown()">
                <iconify-icon icon="mdi:minus" class="align-middle"></iconify-icon> 1
              </button>
              <button class="px-3 py-1 bg-gray-100 rounded"
                onclick="this.parentElement.previousElementSibling.stepUp()">
                <iconify-icon icon="mdi:plus" class="align-middle"></iconify-icon> 1
              </button>
            </div>
          </div>
        </div>

        <div class="mb-6 p-4 bg-blue-50 rounded-xl">
          <div class="flex justify-between mb-2">
            <span class="text-gray-700">Estimated Value</span>
            <span class="font-bold">$877.10</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-700">Commission</span>
            <span class="font-bold">$0.00</span>
          </div>
        </div>

        <div class="flex">
          <button class="flex-1 mr-3 py-3 bg-gray-100 rounded-xl font-bold" onclick="closeSellModal()">
            Cancel
          </button>
          <button class="flex-1 py-3 bg-red-600 text-white rounded-xl font-bold flex items-center justify-center"
            onclick="executeSell()">
            <iconify-icon icon="mdi:cart-check" class="mr-2"></iconify-icon>
            Confirm Sell
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- New Portfolio Modal -->
  <div id="newPortfolioModal" class="modal-overlay">
    <div class="flex items-center justify-center h-full">
      <div class="modal-content p-8 w-11/12 max-w-md">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-bold text-gray-800">Create New Portfolio</h3>
          <button onclick="closeNewPortfolioModal()">
            <iconify-icon icon="mdi:close" class="text-2xl"></iconify-icon>
          </button>
        </div>

        <div class="mb-6">
          <label class="block text-gray-700 mb-2">Portfolio Name</label>
          <input type="text" placeholder="Enter portfolio name"
            class="w-full p-3 border border-gray-300 rounded-lg font-medium" id="newPortfolioName">
        </div>

        <div class="mb-6">
          <label class="block text-gray-700 mb-2">Portfolio Type</label>
          <select class="w-full p-3 border border-gray-300 rounded-lg font-medium">
            <option value="stocks">Stocks</option>
            <option value="bonds">Bonds</option>
            <option value="crypto">Cryptocurrency</option>
            <option value="mixed">Mixed Assets</option>
          </select>
        </div>

        <div class="mb-6">
          <label class="block text-gray-700 mb-2">Initial Investment ($)</label>
          <input type="number" step="1000" value="10000"
            class="w-full p-3 border border-gray-300 rounded-lg font-medium">
        </div>

        <div class="flex">
          <button class="flex-1 mr-3 py-3 bg-gray-100 rounded-xl font-bold" onclick="closeNewPortfolioModal()">
            Cancel
          </button>
          <button class="flex-1 py-3 bg-green-500 text-white rounded-xl font-bold flex items-center justify-center"
            onclick="createNewPortfolio()">
            <iconify-icon icon="mdi:plus" class="mr-2"></iconify-icon>
            Create Portfolio
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Position Modal -->
  <div id="addPositionModal" class="modal-overlay">
    <div class="flex items-center justify-center h-full">
      <div class="modal-content p-8 w-11/12 max-w-md">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-bold text-gray-800">Add New Position</h3>
          <button onclick="closeAddPositionModal()">
            <iconify-icon icon="mdi:close" class="text-2xl"></iconify-icon>
          </button>
        </div>

        <div class="mb-6">
          <label class="block text-gray-700 mb-2">Select Stock</label>
          <div class="relative">
            <input type="text" placeholder="Search for stocks..."
              class="w-full p-3 border border-gray-300 rounded-lg font-medium" id="stockSearchInput"
              oninput="searchStocks()">
            <div id="stockSearchResults" class="search-results mt-2 absolute z-50 w-full bg-white shadow-md rounded-lg">
            </div>
          </div>
        </div>

        <div class="mb-6">
          <label class="block text-gray-700 mb-2">Quantity</label>
          <input type="number" min="1" value="10" class="w-full p-3 border border-gray-300 rounded-lg font-medium">
        </div>

        <div class="mb-6">
          <label class="block text-gray-700 mb-2">Purchase Price ($)</label>
          <input type="number" step="0.01" value="100.00"
            class="w-full p-3 border border-gray-300 rounded-lg font-medium">
        </div>

        <div class="flex">
          <button class="flex-1 mr-3 py-3 bg-gray-100 rounded-xl font-bold" onclick="closeAddPositionModal()">
            Cancel
          </button>
          <button class="flex-1 py-3 bg-blue-600 text-white rounded-xl font-bold flex items-center justify-center"
            onclick="addNewPosition()">
            <iconify-icon icon="mdi:plus" class="mr-2"></iconify-icon>
            Add Position
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Trade Modal -->
  <div id="tradeModal" class="modal-overlay">
    <div class="flex items-center justify-center h-full">
      <div class="modal-content p-8 w-11/12 max-w-md">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-bold text-gray-800">Confirm Trade</h3>
          <button onclick="closeTradeModal()">
            <iconify-icon icon="mdi:close" class="text-2xl"></iconify-icon>
          </button>
        </div>

        <div class="flex items-center mb-6">
          <img id="modal-stock-logo" src="https://modao.cc/ai/uploads/ai_pics/6/66433/aigp_1753747632.jpeg"
            alt="Company logo for stock trading" class="w-16 h-16 rounded mr-4">
          <div>
            <p class="font-bold text-lg" id="modal-stock-name">Apple Inc. (AAPL)</p>
            <p class="text-gray-600">Current price: $<span id="modal-stock-price">0.00</span></p>
          </div>
        </div>

        <div class="mb-6">
          <label class="block text-gray-700 mb-3">Quantity</label>
          <div class="relative">
            <input type="number" min="1" value="10" class="w-full p-3 border border-gray-300 rounded-lg font-medium">
            <div class="flex justify-between mt-2 text-sm">
              <button class="px-3 py-1 bg-gray-100 rounded"
                onclick="this.parentElement.previousElementSibling.stepDown()">
                <iconify-icon icon="mdi:minus" class="align-middle"></iconify-icon> 1
              </button>
              <button class="px-3 py-1 bg-gray-100 rounded"
                onclick="this.parentElement.previousElementSibling.stepUp()">
                <iconify-icon icon="mdi:plus" class="align-middle"></iconify-icon> 1
              </button>
            </div>
          </div>
        </div>

        <div class="mb-6 p-4 bg-blue-50 rounded-xl">
          <div class="flex justify-between mb-2">
            <span class="text-gray-700">Estimated Cost</span>
            <span class="font-bold">$1,754.20</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-700">Commission</span>
            <span class="font-bold">$0.00</span>
          </div>
        </div>

        <div class="flex">
          <button class="flex-1 mr-3 py-3 bg-gray-100 rounded-xl font-bold" onclick="closeTradeModal()">
            Cancel
          </button>
          <button class="flex-1 py-3 bg-blue-600 text-white rounded-xl font-bold flex items-center justify-center"
            onclick="executeTrade()">
            <iconify-icon icon="mdi:cart-check" class="mr-2"></iconify-icon>
            Confirm Buy
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Stock data for search suggestions
    const stockData = [
      { name: "Apple Inc.", symbol: "AAPL", price: 175.42, change: 2.35 },
      { name: "Microsoft Corp.", symbol: "MSFT", price: 336.21, change: 1.64 },
      { name: "Amazon.com Inc.", symbol: "AMZN", price: 132.75, change: -0.87 },
      { name: "Tesla Inc.", symbol: "TSLA", price: 258.93, change: -3.25 },
      { name: "Google LLC", symbol: "GOOGL", price: 138.04, change: 1.22 },
      { name: "Netflix Inc.", symbol: "NFLX", price: 483.32, change: 4.63 },
      { name: "Johnson & Johnson", symbol: "JNJ", price: 167.61, change: 0.76 },
      { name: "Visa Inc.", symbol: "V", price: 238.72, change: 0.36 }
    ];

    // 股票详情数据补充
    const stockDetailData = [
      { name: "Apple Inc.", symbol: "AAPL", price: 175.42, change: 2.35, logo: "https://modao.cc/ai/uploads/ai_pics/6/66423/aigp_1753747615.jpeg", desc: "Apple Inc. designs, manufactures, and markets smartphones, personal computers, tablets, wearables, and accessories worldwide." },
      { name: "Microsoft Corp.", symbol: "MSFT", price: 336.21, change: 1.64, logo: "https://modao.cc/ai/uploads/ai_pics/6/66424/aigp_1753747617.jpeg", desc: "Microsoft Corporation develops, licenses, and supports software, services, devices, and solutions worldwide." },
      { name: "Amazon.com Inc.", symbol: "AMZN", price: 132.75, change: -0.87, logo: "https://modao.cc/ai/uploads/ai_pics/6/66425/aigp_1753747619.jpeg", desc: "Amazon.com, Inc. engages in the retail sale of consumer products and subscriptions in North America and internationally." },
      { name: "Tesla Inc.", symbol: "TSLA", price: 258.93, change: -3.25, logo: "https://modao.cc/ai/uploads/ai_pics/6/66426/aigp_1753747621.jpeg", desc: "Tesla, Inc. designs, develops, manufactures, leases, and sells electric vehicles, and energy generation and storage systems." },
      { name: "Google LLC", symbol: "GOOGL", price: 138.04, change: 1.22, logo: "https://modao.cc/ai/uploads/ai_pics/6/66427/aigp_1753747622.jpeg", desc: "Google LLC provides various products and platforms including Search, Maps, Gmail, Android, Google Play, Chrome, and YouTube." },
      { name: "Netflix Inc.", symbol: "NFLX", price: 483.32, change: 4.63, logo: "https://modao.cc/ai/uploads/ai_pics/6/66428/aigp_1753747623.jpeg", desc: "Netflix, Inc. provides entertainment services. It offers TV series, documentaries, feature films, and mobile games." }
    ];

    // View switching function
    function switchPanel(panelId) {
      // 切换内容面板
      ['tradingPanel', 'mainPanel', 'portfolioPanel'].forEach(id => {
        const el = document.getElementById(id);
        if (el) {
          el.style.display = 'none';
          el.classList.add('hidden');
        }
      });
      const showEl = document.getElementById(panelId);
      if (showEl) {
        showEl.style.display = 'block';
        showEl.classList.remove('hidden');
      }

      // 切换左侧导航高亮
      const navBtns = document.querySelectorAll('.glass-nav nav button');
      navBtns.forEach(btn => {
        btn.classList.remove('bg-blue-100', 'text-blue-800', 'font-medium');
        btn.classList.add('text-gray-700');
      });
      // 当前按钮加高亮
      if (panelId === 'mainPanel') {
        navBtns[0].classList.add('bg-blue-100', 'text-blue-800', 'font-medium');
        navBtns[0].classList.remove('text-gray-700');
      } else if (panelId === 'tradingPanel') {
        navBtns[1].classList.add('bg-blue-100', 'text-blue-800', 'font-medium');
        navBtns[1].classList.remove('text-gray-700');
      } else if (panelId === 'portfolioPanel') {
        navBtns[2].classList.add('bg-blue-100', 'text-blue-800', 'font-medium');
        navBtns[2].classList.remove('text-gray-700');
      }

      // Initialize charts when main panel is shown
      if (panelId === 'mainPanel') initCharts();

    }

    // Show search results
    function showSearchResults() {
      const input = document.querySelector('input[type="text"]');
      const resultsContainer = document.getElementById('searchResults');

      if (!input.value) {
        resultsContainer.style.display = 'none';
        return;
      }

      const filteredStocks = stockData.filter(stock =>
        stock.name.toLowerCase().includes(input.value.toLowerCase()) ||
        stock.symbol.toLowerCase().includes(input.value.toLowerCase())
      );

      if (filteredStocks.length === 0) {
        resultsContainer.innerHTML = '<div class="p-4 text-gray-500">No matching stocks found</div>';
        resultsContainer.style.display = 'block';
        return;
      }

      let resultsHTML = '';
      filteredStocks.forEach(stock => {
        const changeClass = stock.change >= 0 ? 'positive-change' : 'negative-change';
        const changeIcon = stock.change >= 0 ?
          '<iconify-icon icon="mdi:trending-up"></iconify-icon>' :
          '<iconify-icon icon="mdi:trending-down"></iconify-icon>';

        resultsHTML += `
          <div class="p-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer flex items-center">
            <div class="flex-1">
              <p class="font-bold">${stock.symbol}</p>
              <p class="text-sm text-gray-600">${stock.name}</p>
            </div>
            <div class="text-right">
              <p class="font-bold">$${stock.price.toFixed(2)}</p>
              <div class="${changeClass} flex items-center justify-end">
                ${changeIcon}
                <span>${stock.change > 0 ? '+' : ''}${stock.change.toFixed(2)}%</span>
              </div>
            </div>
          </div>
        `;
      });

      resultsContainer.innerHTML = resultsHTML;
      resultsContainer.style.display = 'block';
    }

    // Trade modal functions
    let currentStockSymbol = '';
    let currentStockPrice = 0;

    function showTradeModal(symbol, price) {
      currentStockSymbol = symbol;
      currentStockPrice = price;

      const modal = document.getElementById('tradeModal');
      document.getElementById('modal-stock-name').textContent =
        `${stockData.find(s => s.symbol === symbol).name} (${symbol})`;
      document.getElementById('modal-stock-price').textContent =
        price.toFixed(2);
      document.getElementById('modal-stock-logo').src =
        '/mb-potato/image/placeholder.svg';
      document.getElementById('modal-stock-logo').alt =
        `${symbol} company logo`;

      modal.style.display = 'block';
    }

    function closeTradeModal() {
      document.getElementById('tradeModal').style.display = 'none';
    }

    function executeTrade() {
      closeTradeModal();
      alert(`Trade executed: Bought ${currentStockSymbol} at ${currentStockPrice}`);
    }

    // Sell modal functions
    function showSellModal(symbol, price) {
      currentStockSymbol = symbol;
      currentStockPrice = price;

      const modal = document.getElementById('sellModal');
      document.getElementById('modal-sell-name').textContent =
        `${stockData.find(s => s.symbol === symbol).name} (${symbol})`;
      document.getElementById('modal-sell-price').textContent =
        price.toFixed(2);
      document.getElementById('modal-sell-logo').src =
        '/mb-potato/image/placeholder.svg';
      document.getElementById('modal-sell-logo').alt =
        `${symbol} company logo`;

      modal.style.display = 'block';
    }

    function closeSellModal() {
      document.getElementById('sellModal').style.display = 'none';
    }

    function executeSell() {
      closeSellModal();
      alert(`Sale executed: Sold ${currentStockSymbol} at ${currentStockPrice}`);
    }

    // Add position modal functions
    function showAddPositionModal() {
      document.getElementById('addPositionModal').style.display = 'block';
    }

    function closeAddPositionModal() {
      document.getElementById('addPositionModal').style.display = 'none';
    }

    function searchStocks() {
      const input = document.getElementById('stockSearchInput');
      const resultsContainer = document.getElementById('stockSearchResults');

      if (!input.value) {
        resultsContainer.style.display = 'none';
        return;
      }

      const filteredStocks = stockData.filter(stock =>
        stock.name.toLowerCase().includes(input.value.toLowerCase()) ||
        stock.symbol.toLowerCase().includes(input.value.toLowerCase())
      );

      if (filteredStocks.length === 0) {
        resultsContainer.innerHTML = '<div class="p-4 text-gray-500">No matching stocks found</div>';
        resultsContainer.style.display = 'block';
        return;
      }

      let resultsHTML = '';
      filteredStocks.forEach(stock => {
        resultsHTML += `
          <div class="p-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer" 
               onclick="selectStock('${stock.symbol}', ${stock.price})">
            <p class="font-bold">${stock.symbol}</p>
            <p class="text-sm text-gray-600">${stock.name}</p>
          </div>
        `;
      });

      resultsContainer.innerHTML = resultsHTML;
      resultsContainer.style.display = 'block';
    }

    function selectStock(symbol, price) {
      document.getElementById('stockSearchInput').value = symbol;
      document.getElementById('stockSearchResults').style.display = 'none';
    }

    function addNewPosition() {
      closeAddPositionModal();
      alert('New position added to portfolio');
    }

    // New Portfolio modal functions
    function showNewPortfolioModal() {
      document.getElementById('newPortfolioModal').style.display = 'block';
    }

    function closeNewPortfolioModal() {
      document.getElementById('newPortfolioModal').style.display = 'none';
    }

    function createNewPortfolio() {
      const portfolioName = document.getElementById('newPortfolioName').value;
      if (!portfolioName) {
        alert('Please enter a portfolio name');
        return;
      }

      // 创建新的投资组合按钮
      const portfolioBtnsContainer = document.querySelector('.flex.gap-4.mb-6.overflow-x-auto');
      const newBtn = document.createElement('button');
      newBtn.className = 'px-5 py-2.5 rounded-xl bg-gray-100 text-gray-700 font-medium portfolio-btn';
      newBtn.setAttribute('data-portfolio', 'portfolio' + (portfolioBtnsContainer.children.length));
      newBtn.textContent = portfolioName;

      // 在New Portfolio按钮之前插入
      portfolioBtnsContainer.insertBefore(newBtn, portfolioBtnsContainer.lastElementChild);

      // 为新按钮添加事件监听
      newBtn.addEventListener('click', function () {
        const portfolioBtns = document.querySelectorAll('.portfolio-btn');
        portfolioBtns.forEach(b => {
          b.classList.remove('active');
          b.classList.remove('bg-blue-600');
          b.classList.remove('text-white');
          b.classList.add('bg-gray-100');
          b.classList.add('text-gray-700');
        });

        this.classList.add('active');
        this.classList.remove('bg-gray-100');
        this.classList.remove('text-gray-700');
        this.classList.add('bg-blue-600');
        this.classList.add('text-white');

        document.getElementById('currentPortfolioName').textContent = this.textContent;
      });

      closeNewPortfolioModal();
      alert('New portfolio "' + portfolioName + '" has been created!');
    }

    // Initialize charts


    // Handle window resize
    window.addEventListener('resize', function () {
      chart.resize();
      pieChart.resize();
    });


    // Portfolio switching
    document.addEventListener('DOMContentLoaded', function () {
      const portfolioBtns = document.querySelectorAll('.portfolio-btn');
      portfolioBtns.forEach(btn => {
        btn.addEventListener('click', function () {
          // 移除所有活动状态
          portfolioBtns.forEach(b => {
            b.classList.remove('active');
            b.classList.remove('bg-blue-600');
            b.classList.remove('text-white');
            b.classList.add('bg-gray-100');
            b.classList.add('text-gray-700');
          });

          // 设置当前按钮为活动状态
          this.classList.add('active');
          this.classList.remove('bg-gray-100');
          this.classList.remove('text-gray-700');
          this.classList.add('bg-blue-600');
          this.classList.add('text-white');

          // 更新当前组合名称
          const portfolioName = this.textContent;
          document.getElementById('currentPortfolioName').textContent = portfolioName;

          // 这里可以添加加载不同组合数据的逻辑
          console.log('Switched to portfolio:', portfolioName);
        });
      });
    });

    // Close search results when clicking outside
    document.addEventListener('click', function (e) {
      if (!document.querySelector('.relative').contains(e.target)) {
        document.getElementById('searchResults').style.display = 'none';
      }
    });

    // Initialize chart if main panel is visible on load
    document.addEventListener('DOMContentLoaded', function () {
      if (document.getElementById('mainPanel').style.display !== 'none') {
        initCharts();
      }
    });

    // 展示股票详情
    function showStockDetail(symbol) {
      // 隐藏其它panel
      ['tradingPanel', 'mainPanel', 'portfolioPanel'].forEach(id => {
        const el = document.getElementById(id);
        if (el) {
          el.style.display = 'none';
          el.classList.add('hidden');
        }
      });
      // 显示详情panel
      const detailPanel = document.getElementById('stockDetailPanel');
      detailPanel.style.display = 'block';
      detailPanel.classList.remove('hidden');

      // 查找数据
      const stock = stockDetailData.find(s => s.symbol === symbol);
      if (stock) {
        document.getElementById('detail-stock-logo').src = stock.logo;
        document.getElementById('detail-stock-logo').alt = stock.name + ' logo';
        document.getElementById('detail-page-title').textContent = stock.name;
        document.getElementById('detail-stock-name').textContent = stock.name;
        document.getElementById('detail-stock-symbol').textContent = stock.symbol;
        document.getElementById('detail-stock-price').textContent = stock.price.toFixed(2);
        // document.getElementById('detail-stock-desc').textContent = stock.desc || 'No description available.';
        const changeDiv = document.getElementById('detail-stock-change');
        if (stock.change >= 0) {
          changeDiv.innerHTML = `<iconify-icon icon="mdi:trending-up" class="text-green-500 mr-1"></iconify-icon>
        <span class="text-green-600 font-bold">+${stock.change}%</span>`;
        } else {
          changeDiv.innerHTML = `<iconify-icon icon="mdi:trending-down" class="text-red-500 mr-1"></iconify-icon>
        <span class="text-red-600 font-bold">${stock.change}%</span>`;
        }
      }
      setTimeout(() => {
        if (myChart) {
            myChart.resize();
            // Update chart with new data
            updateChart(30);
            }
        }, 100);
    }

    // 返回市场概览
    function backToTradingPanel() {
      document.getElementById('stockDetailPanel').style.display = 'none';
      document.getElementById('stockDetailPanel').classList.add('hidden');
      document.getElementById('tradingPanel').style.display = 'block';
      document.getElementById('tradingPanel').classList.remove('hidden');
    }
  </script>

  <script>
    // Initialize chart
    const chartDom = document.getElementById('stockChart');
    const myChart = echarts.init(chartDom, null, {
    renderer: 'canvas',
    useDirtyRect: false
    });

    // Add this after the updateChart function
    window.addEventListener('resize', function() {
    if (myChart) {
        myChart.resize({
        animation: {
            duration: 300
        }
        });
    }
    });
    
    // Generate simulated stock data
    function generateStockData(days = 30) {
      const data = [];
      let date = new Date();
      date.setDate(date.getDate() - days - 10);
      let price = 180 + Math.random() * 10;
      
      for (let i = 0; i < days; i++) {
        if (date.getDay() === 0 || date.getDay() === 6) {
          date.setDate(date.getDate() + 1);
          i--;
          continue;
        }
        
        const change = (Math.random() - 0.45) * 2;
        const open = price;
        const close = open + change;
        const high = Math.max(open, close) + Math.random() * 1.5;
        const low = Math.min(open, close) - Math.random() * 1.5;
        
        const dateStr = `${date.getMonth() + 1}/${date.getDate()}`;
        
        data.push([
          dateStr,
          open.toFixed(2) * 1,
          close.toFixed(2) * 1,
          low.toFixed(2) * 1,
          high.toFixed(2) * 1
        ]);
        
        price = close;
        date.setDate(date.getDate() + 1);
      }
      
      return data;
    }
    
    // Calculate Bollinger Bands
    function calculateBollingerBands(data, period = 20, stdDev = 2) {
      const closePrices = data.map(item => item[2]);
      const bollingerData = [];
      
      for (let i = 0; i < data.length; i++) {
        if (i < period - 1) {
          bollingerData.push([null, null, null]);
          continue;
        }
        
        let sum = 0;
        for (let j = 0; j < period; j++) {
          sum += closePrices[i - j];
        }
        const sma = sum / period;
        
        let variance = 0;
        for (let j = 0; j < period; j++) {
          variance += Math.pow(closePrices[i - j] - sma, 2);
        }
        const std = Math.sqrt(variance / period);
        
        const upper = sma + stdDev * std;
        const lower = sma - stdDev * std;
        
        bollingerData.push([upper.toFixed(2) * 1, sma.toFixed(2) * 1, lower.toFixed(2) * 1]);
      }
      
      return bollingerData;
    }
    
    function calculateYAxisRange(data) {
      const allPrices = [];
      data.forEach(item => {
        allPrices.push(item[1]);
        allPrices.push(item[2]);
        allPrices.push(item[3]);
        allPrices.push(item[4]);
      });
      
      const min = Math.min(...allPrices);
      const max = Math.max(...allPrices);
      const range = max - min;
      const padding = range * 0.1;
      
      return [Math.floor(min - padding), Math.ceil(max + padding)];
    }
    
    function updateChart(days) {
      const effectiveDays = Math.min(days, 90);
      const stockData = generateStockData(effectiveDays);
      const bollingerData = calculateBollingerBands(stockData);
      const [yMin, yMax] = calculateYAxisRange(stockData);
      
      const option = {
        backgroundColor: 'transparent',
        tooltip: {
          trigger: 'axis',
          axisPointer: {
            type: 'cross',
          },
        },
        grid: {
          left: '10',
          right: '10',
          bottom: '30',
          top: '30',
          containLabel: true,
        },
        xAxis: {
          type: 'category',
          data: stockData.map(item => item[0]),
          axisLine: {
            lineStyle: {
              color: '#D1D5DB',
            },
          },
          axisLabel: {
            color: '#6B7280',
          },
          splitLine: {
            lineStyle: {
              color: '#E5E7EB',
            },
          },
        },
        yAxis: {
          type: 'value',
          min: yMin,
          max: yMax,
          axisLine: {
            lineStyle: {
              color: '#475569',
            },
          },
          axisLabel: {
            color: '#94A3B8',
            formatter: '{value}',
          },
          splitLine: {
            lineStyle: {
              color: 'rgba(71, 85, 105, 0.2)',
            },
          },
        },
        series: [
          {
            type: 'candlestick',
            data: stockData.map(item => [item[1], item[2], item[3], item[4]]),
            itemStyle: {
              color: '#10B981',
              color0: '#EF4444',
              borderColor: '#10B981',
              borderColor0: '#EF4444',
            },
            emphasis: {
              itemStyle: {
                color: '#34D399',
                color0: '#F87171',
                borderColor: '#34D399',
                borderColor0: '#F87171',
              },
            },
            tooltip: {
              formatter: null,
            },
          },
          {
            type: 'line',
            name: 'Bollinger Upper',
            data: bollingerData.map(item => item[0]),
            lineStyle: {
              color: '#60A5FA',
              width: 1,
            },
            showSymbol: false,
            tooltip: {
              formatter: null,
            },
          },
          {
            type: 'line',
            name: 'Bollinger Middle (SMA)',
            data: bollingerData.map(item => item[1]),
            lineStyle: {
              color: '#FBBF24',
              width: 1.5,
            },
            showSymbol: false,
            tooltip: {
              formatter: null,
            },
          },
          {
            type: 'line',
            name: 'Bollinger Lower',
            data: bollingerData.map(item => item[2]),
            lineStyle: {
              color: '#60A5FA',
              width: 1,
            },
            showSymbol: false,
            tooltip: {
              formatter: null,
            },
          },
        ],
      };
      
      myChart.setOption(option);
    }
    
    updateChart(30);
    
    window.addEventListener('resize', () => {
      myChart.resize();
    });
    
    // Period buttons interaction
    const periodButtons = document.querySelectorAll('.flex-wrap button');
    periodButtons.forEach(button => {
      button.addEventListener('click', function () {
        periodButtons.forEach(btn => {
          btn.classList.remove('active-period');
          btn.classList.add('inactive-period');
        });
        
        this.classList.remove('inactive-period');
        this.classList.add('active-period');
        
        const days = parseInt(this.getAttribute('data-days'));
        updateChart(days);
      });
    });
  </script>

</body>

</html>